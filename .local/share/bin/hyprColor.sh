#!/usr/bin/env sh

# Set the path to the pywal colors file
pywal_colors="$HOME/.cache/wal/colors.sh"

# Set the path to the Hyprland colors file
hypr_colors="$HOME/.config/hypr/themes/hyprlock-color.conf"

# Function to convert hexadecimal color to RGB
hex_to_rgb() {
    r=$(printf "%d" 0x${1:0:2})
    g=$(printf "%d" 0x${1:2:2})
    b=$(printf "%d" 0x${1:4:2})
    echo "rgb($r, $g, $b)"
}

# Check if the pywal colors file exists
if [ -f "$pywal_colors" ]; then
    # Source the pywal colors file
    source "$pywal_colors"

    # Check if the Hyprland colors file exists
    if [ -f "$hypr_colors" ]; then
        # Overwrite the existing Hyprland colors file
        echo "# Colors generated by pywal" > "$hypr_colors"
    else
        # Create a new Hyprland colors file
        mkdir -p "$(dirname "$hypr_colors")"
        echo "# Colors generated by pywal" > "$hypr_colors"
    fi

    # Define the Hyprland color variables in RGB format
    color_vars=("background" "foreground" "cursor" "color0" "color1" "color2" "color3" "color4" "color5" "color6" "color7" "color8" "color9" "color10" "color11" "color12" "color13" "color14" "color15")

    for var in "${color_vars[@]}"; do
        color_value="${!var#?}" # Get the value of the variable without the '#' prefix
        rgb_color=$(hex_to_rgb "$color_value")
        echo "\$$var=$rgb_color" >> "$hypr_colors"
    done

    exit 0
else
    echo "Error: pywal colors file not found: $pywal_colors"
fi
